<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Spiel: Service Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="spiel.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.htm"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.htm"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.htm"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.htm"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.htm"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_spiel_1_1_service.htm','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="class_spiel_1_1_service-members.htm">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Service Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3eb1842e9501fc08d3d24c3648336f8d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#a3eb1842e9501fc08d3d24c3648336f8d">__construct</a> (<a class="el" href="interface_spiel_1_1_service_user_manager.htm">ServiceUserManager</a> $userManager, $file, $description, <a class="el" href="interface_spiel_1_1_session.htm">Session</a> $session=NULL, $trimParamValues=TRUE)</td></tr>
<tr class="separator:a3eb1842e9501fc08d3d24c3648336f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94683a27125ebfa3741678989d588d2a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute</a> (<a class="el" href="class_spiel_1_1_service_user.htm">ServiceUser</a> $currentUser, $params)</td></tr>
<tr class="separator:a94683a27125ebfa3741678989d588d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa06ade9ef44f086fe39f9c06872494a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#aa06ade9ef44f086fe39f9c06872494a0">getRequiredParameters</a> ()</td></tr>
<tr class="separator:aa06ade9ef44f086fe39f9c06872494a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ff136d93d66c4f192eca5e5bc9dd22f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#a5ff136d93d66c4f192eca5e5bc9dd22f">getOptionalParameters</a> ()</td></tr>
<tr class="separator:a5ff136d93d66c4f192eca5e5bc9dd22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320977f451c736f368485be6835d2d4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#a320977f451c736f368485be6835d2d4b">getDataReturned</a> ()</td></tr>
<tr class="separator:a320977f451c736f368485be6835d2d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8f8e757e5b09725c57d365deab6d87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#a6e8f8e757e5b09725c57d365deab6d87">getPermissionType</a> ()</td></tr>
<tr class="separator:a6e8f8e757e5b09725c57d365deab6d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6090bafcfcbf21e7b882cd3d8df89e03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_spiel_1_1_service.htm#a6090bafcfcbf21e7b882cd3d8df89e03">getPermissionRequired</a> ()</td></tr>
<tr class="separator:a6090bafcfcbf21e7b882cd3d8df89e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class represents a web service as can be implemented using Spiel. If the client requests the implementing web service without an "x" parameter, the superclass will return helpful interface documentation to the client. If the client requests the implementing web service with an "x" parameter, this function will ensure that the client has specified any other required parameters as indicated by the <code><a class="el" href="class_spiel_1_1_service.htm#aa06ade9ef44f086fe39f9c06872494a0">getRequiredParameters()</a></code> method, and then it will call the <code><a class="el" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute()</a></code> method on the subclass implementation. As a result, the actual implementation of the web service is primarily done within the implemented <code><a class="el" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute()</a></code> method. The <code><a class="el" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute()</a></code> method's return value is a <code><a class="el" href="class_spiel_1_1_service_response.htm">ServiceResponse</a></code> object which will be sent to the requesting client.</p>
<p>Typical usage of this superclass is defining the subclass, implementing its <code><a class="el" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute()</a></code> method, and then instantiating a new instance of it. For example:</p>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line">    require_once(<span class="stringliteral">&quot;spiel.php&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">class </span>ServiceImpl <span class="keyword">extends</span> <a class="code" href="class_spiel_1_1_service.htm">\Spiel\Service</a></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_spiel_1_1_service.htm#a3eb1842e9501fc08d3d24c3648336f8d">__construct</a>()</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Pass arguments specific to this service to the superclass</span></div>
<div class="line">            parent::__construct(...);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute</a>(\Spiel\ServiceUser $currentUser, $params)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Implement the service as you see fit</span></div>
<div class="line">            ...</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Make sure you return a response, for example:</span></div>
<div class="line">            <span class="keywordflow">return</span> new \Spiel\SuccessServiceResponse();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keyword">new</span> ServiceImpl();</div>
<div class="line">?&gt;</div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3eb1842e9501fc08d3d24c3648336f8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_spiel_1_1_service_user_manager.htm">ServiceUserManager</a>&#160;</td>
          <td class="paramname"><em>$userManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_spiel_1_1_session.htm">Session</a>&#160;</td>
          <td class="paramname"><em>$session</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$trimParamValues</em> = <code>TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\Spiel\ServiceUserManager</td><td class="paramname">$userManager</td><td>The <code><a class="el" href="interface_spiel_1_1_service_user_manager.htm">ServiceUserManager</a></code> that can be used to query for information on the current user making the service request.</td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>The full path to the file containing the web service implementation. Passing the value of the <code>__FILE__</code> constant is an easy way to provide this.</td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$description</td><td>A description of this web service that will be put in the interface documentation accessible to the client.</td></tr>
    <tr><td class="paramtype">\Spiel\Session</td><td class="paramname">$session</td><td>The <code><a class="el" href="interface_spiel_1_1_session.htm">Session</a></code> object that can be used to look up the current login session information. If <code>NULL</code>, a new instance of a <code><a class="el" href="class_spiel_1_1_p_h_p_session.htm">PHPSession</a></code> class will be used.</td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$trimParamValues</td><td><code>TRUE</code> if parameter values to this web service should have whitespace trimmed from their ends prior to passing them to the <code><a class="el" href="class_spiel_1_1_service.htm#a94683a27125ebfa3741678989d588d2a">execute()</a></code> method or <code>FALSE</code> if not. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a94683a27125ebfa3741678989d588d2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">execute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_spiel_1_1_service_user.htm">ServiceUser</a>&#160;</td>
          <td class="paramname"><em>$currentUser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method must be implemented by subclasses and will be called when the implementing web service is being invoked and all required prerequisites for invocation have been met (e.g., client's user is logged in, required parameters are present in the request, etc.).</p>
<p>Note that any <code>Exception</code>s thrown by this method will be caught and an error response will be sent to the client. The method should return a <code><a class="el" href="class_spiel_1_1_service_response.htm">ServiceResponse</a></code> object indicating the result of the service; this response will be sent to the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\Spiel\ServiceUser</td><td class="paramname">$currentUser</td><td>A <code><a class="el" href="class_spiel_1_1_service_user.htm">ServiceUser</a></code> object providing information on the user currently logged into the system on the client. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>An associative array of parameter names to parameter values indicating the parameters applicable to this web service and the values the client passed. For any optional parameters which the client did not specify, the value will be <code>FALSE</code>. Note that values are already URL-decoded before being passed to this method. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The response to return to the client. If the web service does not return a standard response but instead does something like start a file download, return <code>NULL</code>. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\Exception</td><td>if an error occurs. Any such exception will be caught by Spiel and an error response will be sent to the client with the value returned by the <code>Exception</code>'s <code>getMessage()</code> method being placed into the <code>message</code> property of the <code><a class="el" href="class_spiel_1_1_service_response.htm">ServiceResponse</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a320977f451c736f368485be6835d2d4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getDataReturned </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method can be overridden by service implementations to specify the data returned from the web service. By default, this method returns <code>NULL</code>, meaning that no data is returned in the <code>data</code> property of the response from the web service. </p>
<dl class="section return"><dt>Returns</dt><dd>A string or non-associative array which describes the data returned in the <code>data</code> property of the JSON-encoded object returned from this web service. If no data is provided by this web service, return <code>NULL</code>. If the web service doesn't return a JSON-encoded object at all (for example, the web service starts a file download), return <code>FALSE</code>. Otherwise, this return value can be one of three things:</dd></dl>
<ol type="1">
<li>A string identifying the class name of the type of <code><a class="el" href="interface_spiel_1_1_j_s_o_n_encodable.htm">JSONEncodable</a></code> object the result is. Note that simple scalar values can be returned by specifying an empty string.</li>
<li>A non-associative array containing one value which is the string identifying the class name of the type of <code><a class="el" href="interface_spiel_1_1_j_s_o_n_encodable.htm">JSONEncodable</a></code> objects present in each value of the array. You would use this type of value if the data consists of an array of objects.</li>
<li>A non-associative array containing <em>no</em> values. This means that the data value is an array of scalar values. </li>
</ol>

</div>
</div>
<a class="anchor" id="a5ff136d93d66c4f192eca5e5bc9dd22f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getOptionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method can be overridden by service implementations to specify any optional parameters the service can use while executing. By default, this method returns an empty array, meaning that there are no optional parameters. </p>
<dl class="section return"><dt>Returns</dt><dd>array An associative array of any optional request parameters that can be present that this web service will use when it executes. The key is the request parameter name; the value is a short description of that parameter which will be put in the interface documentation accessible to the client. </dd></dl>

</div>
</div>
<a class="anchor" id="a6090bafcfcbf21e7b882cd3d8df89e03"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getPermissionRequired </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method can be overridden by service implementations to specify the permission required to access the web service. By default, this method returns <code>NULL</code>, meaning no permission is required to use the web service. </p>
<dl class="section return"><dt>Returns</dt><dd>integer A value from the permission <code><a class="el" href="class_spiel_1_1_enum.htm">Enum</a></code> that identifies the permission required to access this web service. If no permissions are required to access this web service, return <code>NULL</code>. </dd></dl>

</div>
</div>
<a class="anchor" id="a6e8f8e757e5b09725c57d365deab6d87"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getPermissionType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method can be overridden by service implementations to specify the type of permission required to access the web service. By default, this method returns <code>NULL</code>, meaning no permission is required to use the web service. </p>
<dl class="section return"><dt>Returns</dt><dd>An <code><a class="el" href="class_spiel_1_1_enum.htm">Enum</a></code> object indicating the category of permission required by this web service. If no permissions are required to access this web service, return <code>NULL</code>. </dd></dl>

</div>
</div>
<a class="anchor" id="aa06ade9ef44f086fe39f9c06872494a0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getRequiredParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method can be overridden by service implementations to specify any parameters the service requires in order to execute. By default, this method returns an empty array, meaning that there are no required parameters. </p>
<dl class="section return"><dt>Returns</dt><dd>array An associative array of any required request parameters that must be present in order for the web service to execute. The key is the request parameter name; the value is a short description of that parameter which will be put in the interface documentation accessible to the client. If this web service does not require any parameters to execute, return an empty array. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Service.php</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Spiel</b></li><li class="navelem"><a class="el" href="class_spiel_1_1_service.htm">Service</a></li>
    <li class="footer">Generated on Fri Feb 7 2014 06:37:31 for Spiel by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
